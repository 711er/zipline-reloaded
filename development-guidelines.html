
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Development Guidelines &#8212; Zipline 2.0.0rc4 documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.9cbddbe73919dad2dc02138ed54fcd50.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    
  <link rel="preload" as="script" href="_static/js/index.a26b4849e0a18c48af57.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/zipline.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">


    
    <a class="navbar-brand" href="index.html">
      <p class="title">Zipline</p>
    </a>
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    
    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="install.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="beginner-tutorial.html">
  Tutorial
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="bundles.html">
  Data
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="trading-calendars.html">
  Trading Calendars
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="risk-and-perf-metrics.html">
  Metrics
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api-reference.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="releases.html">
  Releases
 </a>
</li>

        
      </ul>

      <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/stefan-jansen/zipline-reloaded" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/ml4trading" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-development-environment">
   Creating a Development Environment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#development-with-docker">
   Development with Docker
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#style-guide-running-tests">
   Style Guide &amp; Running Tests
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#continuous-integration">
   Continuous Integration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packaging">
   Packaging
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating-dependencies">
   Updating dependencies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#contributing-to-the-docs">
   Contributing to the Docs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#commit-messages">
   Commit messages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#formatting-docstrings">
   Formatting Docstrings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating-the-whatsnew">
   Updating the Whatsnew
  </a>
 </li>
</ul>

</nav>


              
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="development-guidelines">
<h1>Development Guidelines<a class="headerlink" href="#development-guidelines" title="Permalink to this headline">¶</a></h1>
<p>This page is intended for developers of Zipline, people who want to contribute to the Zipline codebase or documentation, or people who want to install from source and make local changes to their copy of Zipline.</p>
<p>All contributions, bug reports, bug fixes, documentation improvements, enhancements and ideas are welcome. We <a class="reference external" href="https://github.com/quantopian/zipline/issues">track issues</a> on <a class="reference external" href="https://github.com/">GitHub</a> and also have a <a class="reference external" href="https://groups.google.com/forum/#!forum/zipline">mailing list</a> where you can ask questions.</p>
<div class="section" id="creating-a-development-environment">
<h2>Creating a Development Environment<a class="headerlink" href="#creating-a-development-environment" title="Permalink to this headline">¶</a></h2>
<p>First, you’ll need to clone Zipline by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone git@github.com:your-github-username/zipline.git
</pre></div>
</div>
<p>Then check out to a new branch where you can make your changes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git checkout -b some-short-descriptive-name
</pre></div>
</div>
<p>If you don’t already have them, you’ll need some C library dependencies. You can follow the <a class="reference external" href="install.html">install guide</a> to get the appropriate dependencies.</p>
<p>Once you’ve created and activated a <a class="reference external" href="https://docs.python.org/3/library/venv.html">virtual environment</a>, run the <code class="docutils literal notranslate"><span class="pre">etc/dev-install</span></code> script to install all development dependencies in their required order:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python3 -m venv venv
$ <span class="nb">source</span> venv/bin/activate
$ etc/dev-install
</pre></div>
</div>
<p>Or, using <a class="reference external" href="https://virtualenvwrapper.readthedocs.io/en/latest/">virtualenvwrapper</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mkvirtualenv zipline
$ etc/dev-install
</pre></div>
</div>
<p>After installation, you should be able to use the <code class="docutils literal notranslate"><span class="pre">zipline</span></code> command line interface from your virtualenv:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ zipline --help
</pre></div>
</div>
<p>To finish, make sure <a class="reference external" href="#style-guide-running-tests">tests</a> pass.</p>
<p>If you get an error running nosetests after setting up a fresh virtualenv, please try running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># where zipline is the name of your virtualenv</span>
$ deactivate zipline
$ workon zipline
</pre></div>
</div>
<p>During development, you can rebuild the C extensions by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python setup.py build_ext --inplace
</pre></div>
</div>
</div>
<div class="section" id="development-with-docker">
<h2>Development with Docker<a class="headerlink" href="#development-with-docker" title="Permalink to this headline">¶</a></h2>
<p>If you want to work with zipline using a <a class="reference external" href="https://docs.docker.com/get-started/">Docker</a> container, you’ll need to build the <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> in the Zipline root directory, and then build <code class="docutils literal notranslate"><span class="pre">Dockerfile-dev</span></code>. Instructions for building both containers can be found in <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> and <code class="docutils literal notranslate"><span class="pre">Dockerfile-dev</span></code>, respectively.</p>
</div>
<div class="section" id="style-guide-running-tests">
<h2>Style Guide &amp; Running Tests<a class="headerlink" href="#style-guide-running-tests" title="Permalink to this headline">¶</a></h2>
<p>We use <a class="reference external" href="https://flake8.pycqa.org/en/latest/">flake8</a> for checking style requirements and <a class="reference external" href="https://nose.readthedocs.io/en/latest/">nosetests</a> to run Zipline tests. Our <a class="reference external" href="https://en.wikipedia.org/wiki/Continuous_integration">continuous integration</a> tools will run these commands.</p>
<p>Before submitting patches or pull requests, please ensure that your changes pass when running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ flake8 zipline tests
</pre></div>
</div>
<p>In order to run tests locally, you’ll need <a class="reference external" href="https://mrjbq7.github.io/ta-lib/install.html">TA-lib</a>, which you can install on Linux by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ wget http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz
$ tar -xvzf ta-lib-0.4.0-src.tar.gz
$ <span class="nb">cd</span> ta-lib/
$ ./configure --prefix<span class="o">=</span>/usr
$ make
$ sudo make install
</pre></div>
</div>
<p>And for <code class="docutils literal notranslate"><span class="pre">TA-lib</span></code> on OS X you can just run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ brew install ta-lib
</pre></div>
</div>
<p>Then run <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> TA-lib:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install -r ./etc/requirements_talib.in -c ./etc/requirements_locked.txt
</pre></div>
</div>
<p>You should now be free to run tests:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ nosetests
</pre></div>
</div>
</div>
<div class="section" id="continuous-integration">
<h2>Continuous Integration<a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h2>
<p>We use <a class="reference external" href="https://travis-ci.org/quantopian/zipline">Travis CI</a> for Linux-64 bit builds and <a class="reference external" href="https://ci.appveyor.com/project/quantopian/zipline">AppVeyor</a> for Windows-64 bit builds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not currently have CI for OSX-64 bit builds. 32-bit builds may work but are not included in our integration tests.</p>
</div>
</div>
<div class="section" id="packaging">
<h2>Packaging<a class="headerlink" href="#packaging" title="Permalink to this headline">¶</a></h2>
<p>To learn about how we build Zipline conda packages, you can read <a class="reference external" href="release-process.html#uploading-conda-packages">this</a> section in our release process notes.</p>
</div>
<div class="section" id="updating-dependencies">
<h2>Updating dependencies<a class="headerlink" href="#updating-dependencies" title="Permalink to this headline">¶</a></h2>
<p>If you update the zipline codebase so that it now depends on a new version of a library,
then you should update the lower bound on that dependency in <code class="docutils literal notranslate"><span class="pre">etc/requirements.in</span></code>
(or <code class="docutils literal notranslate"><span class="pre">etc/requirements_dev.in</span></code> as appropriate).
We use <a class="reference external" href="https://github.com/jazzband/pip-tools/">pip-compile</a> to find mutually compatible versions of dependencies for the
<code class="docutils literal notranslate"><span class="pre">etc/requirements_locked.txt</span></code> lockfile used in our CI environments.</p>
<p>When you update a dependency in an <code class="docutils literal notranslate"><span class="pre">.in</span></code> file,
you need to re-run the <code class="docutils literal notranslate"><span class="pre">pip-compile</span></code> command included in the header of <a class="reference external" href="https://github.com/quantopian/zipline/tree/master/etc/requirements_locked.txt">the lockfile</a>;
otherwise the lockfile will not meet the constraints specified to pip by zipline
at install time (via <code class="docutils literal notranslate"><span class="pre">etc/requirements.in</span></code> via <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>).</p>
<p>If the zipline codebase can still support an old version of a dependency, but you want
to update to a newer version of that library in our CI environments, then only the
lockfile needs updating. To update the lockfile without bumping the lower bound,
re-run the <code class="docutils literal notranslate"><span class="pre">pip-compile</span></code> command included in the header of the lockfile with the
addition of the <code class="docutils literal notranslate"><span class="pre">--upgrade-package</span></code> or <code class="docutils literal notranslate"><span class="pre">-P</span></code> <a class="reference external" href="https://github.com/jazzband/pip-tools/#updating-requirements">flag</a>, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip-compile --output-file<span class="o">=</span>etc/reqs.txt etc/reqs.in ... -P <span class="nv">six</span><span class="o">==</span><span class="m">1</span>.13.0 -P <span class="s2">&quot;click&gt;4.0.0&quot;</span>
</pre></div>
</div>
<p>As you can see above, you can include multiple such constraints in a single invocation of <code class="docutils literal notranslate"><span class="pre">pip-compile</span></code>.</p>
</div>
<div class="section" id="contributing-to-the-docs">
<h2>Contributing to the Docs<a class="headerlink" href="#contributing-to-the-docs" title="Permalink to this headline">¶</a></h2>
<p>If you’d like to contribute to the documentation on zipline.io, you can navigate to <code class="docutils literal notranslate"><span class="pre">docs/source/</span></code> where each <a class="reference external" href="https://en.wikipedia.org/wiki/ReStructuredText">reStructuredText</a> (<code class="docutils literal notranslate"><span class="pre">.rst</span></code>) file is a separate section there. To add a section, create a new file called <code class="docutils literal notranslate"><span class="pre">some-descriptive-name.rst</span></code> and add <code class="docutils literal notranslate"><span class="pre">some-descriptive-name</span></code> to <code class="docutils literal notranslate"><span class="pre">appendix.rst</span></code>. To edit a section, simply open up one of the existing files, make your changes, and save them.</p>
<p>We use <a class="reference external" href="https://www.sphinx-doc.org/en/master/">Sphinx</a> to generate documentation for Zipline, which you will need to install by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install -r ./etc/requirements_docs.in -c ./etc/requirements_locked.txt
</pre></div>
</div>
<p>If you would like to use Anaconda, please follow <a class="reference internal" href="install.html#managing-conda-environments"><span class="std std-ref">the installation guide</span></a> to create and activate an environment, and then run the command above.</p>
<p>To build and view the docs locally, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># assuming you&#39;re in the Zipline root directory</span>
$ <span class="nb">cd</span> docs
$ make html
$ <span class="o">{</span>BROWSER<span class="o">}</span> build/html/index.html
</pre></div>
</div>
</div>
<div class="section" id="commit-messages">
<h2>Commit messages<a class="headerlink" href="#commit-messages" title="Permalink to this headline">¶</a></h2>
<p>Standard prefixes to start a commit message:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>BLD: change related to building Zipline
BUG: bug fix
DEP: deprecate something, or remove a deprecated object
DEV: development tool or utility
DOC: documentation
ENH: enhancement
MAINT: maintenance commit (refactoring, typos, etc)
REV: revert an earlier commit
STY: style fix (whitespace, PEP8, flake8, etc)
TST: addition or modification of tests
REL: related to releasing Zipline
PERF: performance enhancements
</pre></div>
</div>
<p>Some commit style guidelines:</p>
<p>Commit lines should be no longer than <a class="reference external" href="https://git-scm.com/book/en/v2/Distributed-Git-Contributing-to-a-Project">72 characters</a>. The first line of the commit should include one of the above prefixes. There should be an empty line between the commit subject and the body of the commit. In general, the message should be in the imperative tense. Best practice is to include not only what the change is, but why the change was made.</p>
<p><strong>Example:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>MAINT: Remove unused calculations of max_leverage, et al.

In the performance period the max_leverage, max_capital_used,
cumulative_capital_used were calculated but not used.

At least one of those calculations, max_leverage, was causing a
divide by zero error.

Instead of papering over that error, the entire calculation was
a bit suspect so removing, with possibility of adding it back in
later with handling the case (or raising appropriate errors) when
the algorithm has little cash on hand.
</pre></div>
</div>
</div>
<div class="section" id="formatting-docstrings">
<h2>Formatting Docstrings<a class="headerlink" href="#formatting-docstrings" title="Permalink to this headline">¶</a></h2>
<p>When adding or editing docstrings for classes, functions, etc, we use <a class="reference external" href="https://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt">numpy</a> as the canonical reference.</p>
</div>
<div class="section" id="updating-the-whatsnew">
<h2>Updating the Whatsnew<a class="headerlink" href="#updating-the-whatsnew" title="Permalink to this headline">¶</a></h2>
<p>We have a set of <a class="reference external" href="https://github.com/quantopian/zipline/tree/master/docs/source/whatsnew">whatsnew</a> files that are used for documenting changes that have occurred between different versions of Zipline.
Once you’ve made a change to Zipline, in your Pull Request, please update the most recent <code class="docutils literal notranslate"><span class="pre">whatsnew</span></code> file with a comment about what you changed. You can find examples in previous <code class="docutils literal notranslate"><span class="pre">whatsnew</span></code> files.</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="_static/js/index.a26b4849e0a18c48af57.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-74956955-3', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020, Quantopian Inc..<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>